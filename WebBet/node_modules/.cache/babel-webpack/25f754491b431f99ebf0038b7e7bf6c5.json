{"ast":null,"code":"import { environment } from 'src/environments/environment';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"src/app/services/client-api.service\";\nimport * as i2 from \"src/app/services/main.service\";\nimport * as i3 from \"src/app/services/token.service\";\nimport * as i4 from \"@angular/common\";\n\nfunction AnnouncementComponent_div_4_div_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 7);\n    i0.ɵɵelementStart(1, \"div\", 8);\n    i0.ɵɵelementStart(2, \"p\");\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"div\", 9);\n    i0.ɵɵtext(5);\n    i0.ɵɵpipe(6, \"date\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const announcement_r3 = ctx.$implicit;\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(announcement_r3.ticker);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\" \", i0.ɵɵpipeBind2(6, 2, announcement_r3.date, \"medium\"), \" \");\n  }\n}\n\nfunction AnnouncementComponent_div_4_p_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"p\", 10);\n    i0.ɵɵtext(1, \"No announcements available\");\n    i0.ɵɵelementEnd();\n  }\n}\n\nfunction AnnouncementComponent_div_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 3);\n    i0.ɵɵelementStart(1, \"div\", 4);\n    i0.ɵɵtemplate(2, AnnouncementComponent_div_4_div_2_Template, 7, 5, \"div\", 5);\n    i0.ɵɵtemplate(3, AnnouncementComponent_div_4_p_3_Template, 2, 0, \"p\", 6);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r0.vnews);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r0.vnews.length === 0);\n  }\n}\n\nexport let AnnouncementComponent = /*#__PURE__*/(() => {\n  class AnnouncementComponent {\n    constructor(userService, main, tokenService) {\n      this.userService = userService;\n      this.main = main;\n      this.tokenService = tokenService;\n      this.news = \"\";\n      this.vnews = [];\n      this.siteName = environment.siteName;\n      this.newsPending = false;\n      this.newsPending2 = false;\n      this.isLogin = false;\n\n      if (this.tokenService.getToken()) {\n        this.isLogin = true;\n      }\n\n      if (this.isLogin) {\n        this.main.apis$.subscribe(res => {\n          this.getticker();\n          this.getNews();\n        });\n      }\n    }\n\n    ngOnInit() {}\n\n    getNews() {\n      if (this.newsPending) {\n        return;\n      }\n\n      this.newsPending = true;\n      this.vnews = [];\n      this.userService.getTicker().subscribe(resp => {\n        if (resp.errorCode == 0) {\n          this.vnews = resp.result.map(t => ({\n            id: t.id,\n            ticker: atob(t.ticker),\n            date: t.date || new Date().toISOString()\n          }));\n        }\n\n        this.newsPending = false;\n      }, err => {\n        this.newsPending = false;\n      });\n    }\n\n    getticker() {\n      if (this.newsPending2) {\n        return;\n      }\n\n      this.newsPending2 = true;\n      this.userService.get_ticker().subscribe(resp => {\n        if (!this.news) {}\n\n        this.news = resp.ticker;\n        this.newsPending2 = false;\n      }, err => {\n        this.newsPending2 = false;\n      });\n    }\n\n  }\n\n  AnnouncementComponent.ɵfac = function AnnouncementComponent_Factory(t) {\n    return new (t || AnnouncementComponent)(i0.ɵɵdirectiveInject(i1.ClientApiService), i0.ɵɵdirectiveInject(i2.MainService), i0.ɵɵdirectiveInject(i3.TokenService));\n  };\n\n  AnnouncementComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: AnnouncementComponent,\n    selectors: [[\"app-announcement\"]],\n    decls: 5,\n    vars: 1,\n    consts: [[1, \"announce-wrap\"], [1, \"announce-header\"], [\"class\", \"announce-content\", \"id\", \"announcementContent\", 4, \"ngIf\"], [\"id\", \"announcementContent\", 1, \"announce-content\"], [\"id\", \"announcementTemplate\", 1, \"article-wrap\"], [\"class\", \"announcement-item\", 4, \"ngFor\", \"ngForOf\"], [\"class\", \"no-announcements\", 4, \"ngIf\"], [1, \"announcement-item\"], [1, \"announcement-content\"], [1, \"announcement-date\"], [1, \"no-announcements\"]],\n    template: function AnnouncementComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0);\n        i0.ɵɵelementStart(1, \"div\", 1);\n        i0.ɵɵelementStart(2, \"h1\");\n        i0.ɵɵtext(3, \"Announcement\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(4, AnnouncementComponent_div_4_Template, 4, 2, \"div\", 2);\n        i0.ɵɵelementEnd();\n      }\n\n      if (rf & 2) {\n        i0.ɵɵadvance(4);\n        i0.ɵɵproperty(\"ngIf\", ctx.isLogin);\n      }\n    },\n    directives: [i4.NgIf, i4.NgForOf],\n    pipes: [i4.DatePipe],\n    styles: [\".announce-wrap[_ngcontent-%COMP%]{background:#1e1e2d;border-radius:4px;padding:15px;color:#fff;max-width:800px;margin:0 auto}.announce-wrap[_ngcontent-%COMP%]   .announce-header[_ngcontent-%COMP%]{border-bottom:1px solid #2b2b40;padding-bottom:10px;margin-bottom:15px}.announce-wrap[_ngcontent-%COMP%]   .announce-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{color:#fff;font-size:1.5rem;margin:0;font-weight:600}.announce-wrap[_ngcontent-%COMP%]   .announce-content[_ngcontent-%COMP%]{max-height:400px;overflow-y:auto;padding-right:5px}.announce-wrap[_ngcontent-%COMP%]   .announce-content[_ngcontent-%COMP%]::-webkit-scrollbar{width:5px}.announce-wrap[_ngcontent-%COMP%]   .announce-content[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#2b2b40;border-radius:3px}.announce-wrap[_ngcontent-%COMP%]   .announce-content[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#5d5d7a;border-radius:3px}.announce-wrap[_ngcontent-%COMP%]   .announcement-item[_ngcontent-%COMP%]{background:#2b2b40;border-radius:4px;padding:12px 15px;margin-bottom:10px;border-left:3px solid #3699ff}.announce-wrap[_ngcontent-%COMP%]   .announcement-item[_ngcontent-%COMP%]:last-child{margin-bottom:0}.announce-wrap[_ngcontent-%COMP%]   .announcement-item[_ngcontent-%COMP%]   .announcement-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0 0 8px;color:#cdcdde;line-height:1.5}.announce-wrap[_ngcontent-%COMP%]   .announcement-item[_ngcontent-%COMP%]   .announcement-date[_ngcontent-%COMP%]{font-size:.8rem;color:#8c8ea4;text-align:right}.announce-wrap[_ngcontent-%COMP%]   .no-announcements[_ngcontent-%COMP%]{color:#8c8ea4;text-align:center;padding:20px 0}\"]\n  });\n  return AnnouncementComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}